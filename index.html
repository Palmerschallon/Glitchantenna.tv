<!doctype html>
<html lang="en">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>glitchantenna.tv ‚Äî simple antenna ‚Ä¢ strange stations</title>
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='30' fill='%230b0c10' stroke='%2300ff88' stroke-width='4'/%3E%3Ccircle cx='24' cy='26' r='4' fill='%2300ff88'/%3E%3Ccircle cx='40' cy='26' r='4' fill='%2300ff88'/%3E%3Cpath d='M20 36q12 14 24 0' fill='none' stroke='%2300ff88' stroke-width='4' stroke-linecap='round'/%3E%3C/svg%3E">

<style>
:root{
  --bg:#0a0b0f; --panel:#0f1219; --ink:#ecf0f7; --muted:#97a0b4;
  --edge:#242a3a; --accent:#00ff88; --glow:rgba(0,255,136,.22);
  --warn:#ff6b6b; --ok:#4ecdc4;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:#0b0e15;color:var(--ink);font:14px/1.55 ui-monospace,Menlo,Consolas,monospace}

/* layout */
.wrap{max-width:1100px;margin:0 auto;padding:12px}
.header{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-bottom:8px}
.brand{display:flex;gap:10px;align-items:center}
.dot{width:10px;height:10px;border-radius:50%;background:var(--accent);box-shadow:0 0 12px var(--glow)}
.k{color:var(--muted)}
.controls{display:flex;gap:8px;align-items:center;margin-left:auto}
.btn{border:1px solid var(--edge);background:#121525;color:var(--ink);padding:8px 10px;border-radius:10px;cursor:pointer}
.btn:active{transform:translateY(1px)}
.badge{border:1px solid var(--edge);padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.02)}
.speaker{cursor:pointer}

.grid{display:grid;grid-template-columns:1.1fr .9fr;gap:14px}
@media (max-width:900px){ .grid{grid-template-columns:1fr; } }

.card{background:rgba(255,255,255,.02);border:1px solid var(--edge);border-radius:14px;padding:12px}

/* CRT */
#tuner{height:280px;border:3px solid #2b2f40;border-radius:14px;position:relative;overflow:hidden;background:black;
  box-shadow:inset 0 0 24px var(--glow),0 0 40px rgba(0,0,0,.25)}
#crt{width:100%;height:100%;display:block}
#scan{position:absolute;inset:0;pointer-events:none;mix-blend-mode:overlay;background:
  repeating-linear-gradient(to bottom, rgba(122,255,183,.10) 0 2px, rgba(0,0,0,0) 2px 4px)}
#vignette{position:absolute;inset:-20px;pointer-events:none;background:
  radial-gradient(ellipse at center, transparent 55%, rgba(0,0,0,.55) 100%)}

#dial{position:absolute;left:10px;right:10px;bottom:10px;height:30px;border:1px solid #2f3b3f;border-radius:10px;
  background:linear-gradient(180deg,#171b26,#0f121a);display:flex;align-items:center}
#thumb{width:18px;height:34px;background:var(--accent);border-radius:5px;box-shadow:0 0 14px var(--glow);
  position:absolute;top:-3px;transform:translateX(-50%);cursor:ew-resize;touch-action:none}
.scale{position:absolute;left:8px;right:8px;top:-14px;display:flex;justify-content:space-between;font-size:11px;color:#8fb}
.signal{position:absolute;top:10px;right:10px;background:#142018;border:1px solid #2e5;color:#aff;padding:2px 8px;border-radius:8px;font-size:11px}

/* log */
.log{height:300px;overflow:auto;background:#0c0f16;border:1px solid var(--edge);border-radius:12px;padding:10px}
.log .dim{color:#8ea0b9}

/* artifacts */
.tiles{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.tile{border:1px solid var(--edge);background:#0f1320;border-radius:12px;padding:10px;cursor:pointer}
.tile:hover{background:#161a2a}
.tile small{color:var(--muted)}
.rota{font-size:11px;color:var(--muted);margin-top:8px}

/* preview modal */
#jump{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:9999}
.box{width:min(920px,94vw);max-height:86vh;background:#0f1219;border:1px solid var(--edge);border-radius:16px;overflow:hidden;display:grid;grid-template-columns:1fr 320px}
@media (max-width:900px){ .box{grid-template-columns:1fr} }
.prev{background:black;min-height:340px;position:relative}
.prev iframe{width:100%;height:100%;border:0}
.prev .fallback{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;color:#9fb;background:radial-gradient(ellipse at center,#0b0f18 0%,#070a10 70%)}
.side{padding:14px;border-left:1px solid var(--edge)}
.side .u{color:#9fb}
.actions{display:flex;gap:8px;margin-top:12px}
.xbtn{padding:10px 12px;border:1px solid var(--edge);border-radius:10px;background:#121525;color:var(--ink);cursor:pointer}
.xbtn.primary{background:var(--accent);color:#00170c;border-color:#00c86d}

/* overlays for CRT */
#bars,#glitch,#degauss{position:absolute;inset:0;pointer-events:none;opacity:0;transition:opacity .25s}
#bars{background:linear-gradient(to right,#fff 16.66%,#fff0 16.66%),
  linear-gradient(to right,#f00 0 16.66%,#0f0 16.66% 33.32%,#00f 33.32% 49.98%,#fff 49.98% 66.64%,#f0f 66.64% 83.3%,#0ff 83.3% 100%);
  filter:saturate(1.1) brightness(1.05);mix-blend-mode:screen}
#glitch{background:repeating-linear-gradient(to bottom, rgba(255,0,128,.18) 0 2px, transparent 2px 4px)}
#degauss{background:radial-gradient(circle at 50% 50%, rgba(0,255,153,.5), transparent 60%);filter:blur(12px)}
</style>

<body>
<div class="wrap">
  <div class="header">
    <div class="brand"><span class="dot"></span>
      <div><strong>glitchantenna.tv</strong><br><span class="k">simple antenna ‚Ä¢ strange stations</span></div>
    </div>
    <div class="controls">
      <button class="btn" id="conBtn">Conscious: off</button>
      <span class="badge">Node: <span id="nodeId"></span></span>
      <button class="btn" id="retune">Tune channel</button>
      <span class="badge speaker" id="mute">üîä</span>
    </div>
  </div>

  <div class="grid">
    <!-- left -->
    <div class="card">
      <div id="tuner">
        <canvas id="crt"></canvas>
        <div id="scan"></div>
        <div id="vignette"></div>
        <div id="bars"></div>
        <div id="glitch"></div>
        <div id="degauss"></div>
        <div class="signal">signal: <span id="sig">0%</span></div>
        <div id="dial"><div class="scale"><span>static</span><span>signal</span></div><div id="thumb"></div></div>
      </div>
      <div id="log" class="log"></div>
    </div>

    <!-- right -->
    <div class="card">
      <h3 style="margin:4px 0 10px">ARTIFACTS</h3>
      <div id="tiles" class="tiles"></div>
      <div class="rota">Tiles rotate every ~12s. Tap ‚ÄúConscious‚Äù (or press <b>b</b>) to change tuner behavior. Press <b>?</b> for note.</div>
      <div id="note" style="display:none;margin-top:10px;border:1px dashed var(--edge);border-radius:12px;padding:10px;color:#cde">
        <b>operator.note</b> ‚Äî Conscious mode adds pre-lock jitter (it ‚Äúhunts‚Äù for jokes). Holding dial near a station prompts a jump; preview tries to embed, otherwise shows a safe card.
      </div>
      <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
        <a class="btn" href="https://x.com/volumeinthevoid" target="_blank" rel="noopener">X / antenna</a>
        <a class="btn" href="https://pump.fun/BjuxUbkKScjGrAdSjYuUYST3zF2pt9457Ns9RZJvpump" target="_blank" rel="noopener">pump.fun</a>
        <a class="btn" href="https://58hpi8cw0n3q.manus.space/" target="_blank" rel="noopener">Manus white page</a>
      </div>
    </div>
  </div>
</div>

<!-- jump / preview modal -->
<div id="jump">
  <div class="box">
    <div class="prev"><iframe id="iframe" sandbox="allow-scripts allow-forms allow-pointer-lock allow-same-origin"></iframe>
      <div class="fallback" id="fallback" hidden>
        <div>
          <div style="opacity:.8">preview blocked by site</div>
          <div id="fallUrl" style="margin-top:6px"></div>
        </div>
      </div>
    </div>
    <div class="side">
      <div class="u">station.lock()</div>
      <div style="font-size:18px;margin:4px 0 2px"><b id="stName"></b></div>
      <div id="stUrl" class="k"></div>
      <div class="actions">
        <button class="xbtn" id="stay">Stay</button>
        <button class="xbtn primary" id="visit">Visit</button>
      </div>
      <div style="margin-top:10px;color:var(--muted);font-size:12px">
        Some sites deny embedding; if the preview stays blank we show a safe card instead.
      </div>
    </div>
  </div>
</div>

<script>
/* util */
const $ = s => document.querySelector(s);
const logEl = $('#log'); const sigEl = $('#sig');
const node = (Math.random().toString(16).slice(2,6)+'-'+Math.random().toString(16).slice(2,5)).toUpperCase();
$('#nodeId').textContent = node;
function log(t){ const ts = new Date().toLocaleTimeString(); logEl.innerHTML = `[${node}] ${ts}  ${t}<br>` + logEl.innerHTML; }

/* stations */
const stations = [
  { name:'void.tv', pos:0.18, url:'https://void.tv' },
  { name:'glitchantenna', pos:0.42, url:'https://glitchantenna.tv' },
  { name:'$GLOOP site', pos:0.63, url:'https://58hpi8cw0n3q.manus.space/' },
  { name:'pump.fun', pos:0.82, url:'https://pump.fun/BjuxUbkKScjGrAdSjYuUYST3zF2pt9457Ns9RZJvpump' }
];

/* state */
let dial = 0.07;
let conscious = false;
let dragging = false;
let holdStart = 0;    // for jump prompt dwell time
let lastNear = null;

/* audio (needs user action) */
const AC = window.AudioContext || window.webkitAudioContext;
let actx, outGain, noiseSrc, noiseGain, muted=false;
function initAudio(){
  if(actx) return;
  actx = new AC();
  outGain = actx.createGain(); outGain.gain.value = 0.18; outGain.connect(actx.destination);
  // noise
  const len = 2*actx.sampleRate;
  const buf = actx.createBuffer(1,len,actx.sampleRate);
  const data = buf.getChannelData(0); for(let i=0;i<len;i++) data[i] = Math.random()*2-1;
  noiseSrc = actx.createBufferSource(); noiseSrc.buffer = buf; noiseSrc.loop = true;
  noiseGain = actx.createGain(); noiseGain.gain.value = 0.22;
  noiseSrc.connect(noiseGain).connect(outGain); noiseSrc.start();
}
$('#mute').addEventListener('click',()=>{ initAudio(); muted=!muted; outGain.gain.value = muted?0:0.18; $('#mute').textContent = muted?'üîà':'üîä'; });

/* conscious toggle (button + key) */
function setConscious(v){
  conscious = v;
  $('#conBtn').textContent = `Conscious: ${conscious?'on':'off'}`;
  log(`conscious=${conscious}`);
}
$('#conBtn').addEventListener('click',()=>setConscious(!conscious));
addEventListener('keydown',e=>{
  if(e.key==='b'){ setConscious(!conscious); }
  if(e.key==='?'){ const n=$('#note'); n.style.display = n.style.display==='none'?'block':'none'; }
});

/* CRT render */
const canvas = $('#crt'), ctx = canvas.getContext('2d');
const bars = $('#bars'), glitch = $('#glitch'), degauss = $('#degauss');
function resize(){ canvas.width = canvas.clientWidth; canvas.height = canvas.clientHeight; }
addEventListener('resize',resize); resize();

function nearestSignal(x){
  let best = {strength:0, target:null};
  stations.forEach(s=>{
    const d = Math.abs(x - s.pos);
    const falloff = 0.06; // lock width
    const str = Math.max(0, 1 - (d/falloff));
    if(str > best.strength) best = {strength:str, target:s};
  });
  return best;
}

function render(){
  const w=canvas.width, h=canvas.height;
  const {strength, target} = nearestSignal(dial);

  // analog-looking noise: centered distribution + contrast curve
  const img = ctx.createImageData(w,h);
  const baseContrast = 0.85 - 0.45*strength;   // more signal -> less contrast noise
  const bias = 0.5 + (Math.random()-0.5)*0.02; // tiny drift to avoid uniformity
  for(let i=0;i<img.data.length;i+=4){
    // Box-Muller for gaussian-ish noise
    const u=Math.random()||1e-9, v=Math.random()||1e-9;
    let n=Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*v);
    n = (n*0.25 + bias);                    // mean around 0.5
    n = (n - 0.5)*baseContrast + 0.5;       // contrast
    n = Math.max(0, Math.min(1, n));
    const g = Math.floor(n*255);
    img.data[i]=img.data[i+1]=img.data[i+2]=g; img.data[i+3]=255;
  }
  ctx.putImageData(img,0,0);

  // tracking line
  const lineY = (performance.now()/18) % h;
  ctx.fillStyle = `rgba(150,255,200,${0.06 + 0.10*(1-strength)})`;
  ctx.fillRect(0, lineY, w, 2);

  // pre-lock jitter if conscious
  if(conscious && strength<0.9){
    ctx.globalAlpha = 0.18;
    ctx.drawImage(canvas,(Math.random()-0.5)*2,(Math.random()-0.5)*2);
    ctx.globalAlpha = 1;
  }

  // bars fade-in and gentle glitch flutter near strong signal
  bars.style.opacity = (strength>0.55)? (strength-0.55)*2 : 0;
  glitch.style.opacity = (strength>0.9 && Math.sin(performance.now()/120)>0.6) ? .25 : 0;

  // degauss flash when entering a new near window
  if(target!==lastNear && strength>0.7){
    degauss.style.opacity = .75; setTimeout(()=>degauss.style.opacity=0, 180);
    log(`lock?‚Ä¶ carrier near ‚Ä¢ ${target.name}`);
    lastNear = target; holdStart = performance.now();
  }

  // hiss follows signal
  if(noiseGain) noiseGain.gain.value = 0.25*(1-strength)+0.03;

  sigEl.textContent = Math.round(strength*100) + '%';

  // if held close enough long enough ‚Üí prompt
  if(strength>0.88 && performance.now()-holdStart>1200){
    promptJump(target);
    holdStart = performance.now()+999999; // debounce
  }

  requestAnimationFrame(render);
}
requestAnimationFrame(render);

/* dial interaction */
const dialBar = $('#dial'), thumb = $('#thumb');
function setDialFromClientX(x){
  const r = dialBar.getBoundingClientRect();
  let t = (x - r.left)/r.width; t=Math.max(0,Math.min(1,t));
  dial = t; thumb.style.left = (t*100)+'%';
}
dialBar.addEventListener('mousedown',e=>{ dragging=true; setDialFromClientX(e.clientX); initAudio(); });
addEventListener('mousemove',e=>{ if(dragging) setDialFromClientX(e.clientX); });
addEventListener('mouseup',()=> dragging=false);
dialBar.addEventListener('touchstart',e=>{ setDialFromClientX(e.touches[0].clientX); initAudio(); },{passive:true});
dialBar.addEventListener('touchmove',e=>{ setDialFromClientX(e.touches[0].clientX); },{passive:true});

/* retune */
$('#retune').addEventListener('click',()=>{
  initAudio();
  dial = Math.random()*0.95; thumb.style.left = (dial*100)+'%';
  log('tuning‚Ä¶ carrier sweep');
});

/* artifacts (rotate & real actions) */
const sets = [
  [
    {title:'Dial Tone', note:'‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢', kind:'tone'},
    {title:'Color Bars', note:'SMPTE (haunted)', kind:'bars'},
    {title:'Glitch Clip', note:'vertical hold?', kind:'glitch'},
    {title:'X / antenna', note:'broadcast channel', href:'https://x.com/volumeinthevoid'}
  ],
  [
    {title:'Manus Relay', note:'white page ‚Üí signal', href:'https://58hpi8cw0n3q.manus.space/'},
    {title:'pump.fun', note:'chaos liquidity', href:'https://pump.fun/BjuxUbkKScjGrAdSjYuUYST3zF2pt9457Ns9RZJvpump'},
    {title:'Dust Coil', note:'warm hiss', kind:'hiss'},
    {title:'Color Bars', note:'degauss', kind:'bars'}
  ]
];
let rota=0;
function drawTiles(){
  const t = $('#tiles'); t.innerHTML='';
  sets[rota%sets.length].forEach(item=>{
    const el = document.createElement('div'); el.className='tile';
    el.innerHTML = `<div><b>${item.title}</b><br><small>${item.note}</small></div>`;
    el.addEventListener('click',()=>{
      if(item.href){ window.open(item.href,'_blank','noopener'); return; }
      initAudio();
      if(item.kind==='bars'){ bars.style.opacity=1; setTimeout(()=>bars.style.opacity=0,1200); degauss.style.opacity=.7; setTimeout(()=>degauss.style.opacity=0,200); }
      if(item.kind==='tone'){ const osc = actx.createOscillator(); osc.type='sine'; osc.frequency.value=425; osc.connect(outGain); osc.start(); setTimeout(()=>osc.stop(),650); }
      if(item.kind==='glitch'){ glitch.style.opacity=.35; setTimeout(()=>glitch.style.opacity=0,500); }
      if(item.kind==='hiss'){ outGain.gain.value = 0.28; setTimeout(()=>{ outGain.gain.value = muted?0:0.18; },900); }
    });
    t.appendChild(el);
  });
  rota++;
}
drawTiles(); setInterval(drawTiles,12000);

/* jump/preview prompt */
const jump = $('#jump'), iframe = $('#iframe'), fallback = $('#fallback');
const stName = $('#stName'), stUrl = $('#stUrl'), fallUrl = $('#fallUrl');
function promptJump(st){
  stName.textContent = st.name; stUrl.textContent = st.url;
  // try preview
  iframe.src = st.url;
  fallback.hidden = true; iframe.onload = ()=>{ /* if blocked, some sites keep blank; we'll show fallback after timeout */ };
  setTimeout(()=>{ // if still blank-ish, show fallback
    try {
      const blank = !iframe.contentWindow || !iframe.contentDocument || iframe.contentDocument.body.childElementCount===0;
      if(blank){ fallback.hidden = false; fallUrl.textContent = st.url; }
    } catch(e){ // cross-origin access throws -> show fallback
      fallback.hidden = false; fallUrl.textContent = st.url;
    }
  }, 600);
  jump.style.display='flex';
}
$('#stay').addEventListener('click',()=>{ jump.style.display='none'; iframe.src='about:blank'; });
$('#visit').addEventListener('click',()=>{
  const url = stUrl.textContent; window.open(url,'_blank','noopener');
  jump.style.display='none'; iframe.src='about:blank';
});

/* boot */
log('‚Äî IDLE CARRIER ‚Äî');
log('scanning: void.tv ‚Ä¢ antenna handshake');
log('buffering static ‚Ä¢ tracking drift');
</script>
</body>
</html>
