<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>glitchantenna.tv ‚Äî drift the dial</title>
<meta name="description" content="An analog-feeling web tuner. Find weird stations across the net. Static becomes signal; pause to jump.">
<style>
:root{
  --bg:#0b0c10;--panel:#0f1117;--ink:#e9e9ee;--muted:#9fa4b2;--edge:#252a33;--accent:#00ff88;--warn:#ff6b6b;--crt:#1a1d28;
  --scan:#15ff99;--dim:#0b0d13;--glass:#121623;--link:#70ffd1;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:radial-gradient(1200px 700px at 70% -10%, #14182a 0%, var(--bg) 60%);color:var(--ink);font:15px/1.5 ui-sans-serif,system-ui,Inter,Segoe UI,Arial}
a{color:var(--link);text-decoration:none}
a:hover{text-decoration:underline}
.wrap{max-width:1100px;margin:0 auto;padding:14px}
.header{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:10px}
.brand{display:flex;align-items:center;gap:10px}
.logo{width:34px;height:34px;border-radius:6px;border:1px solid #223;background:#0f1117;display:grid;place-items:center;font:700 12px/1 ui-monospace;color:#e9e9ee}
.title{font-weight:700}
.badge{font:11px/1 ui-monospace;color:var(--muted)}
.btn{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border:1px solid var(--edge);border-radius:8px;background:#141826;color:var(--ink);cursor:pointer}
.btn:hover{background:#182032}
.row{display:grid;grid-template-columns:1.1fr .9fr;gap:12px}
@media (max-width:900px){.row{grid-template-columns:1fr}}
.card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border:1px solid var(--edge);border-radius:12px;padding:12px}
h2{font:11px/1 ui-monospace;color:var(--muted);text-transform:uppercase;letter-spacing:.12em;margin:0 0 8px}
.k{color:var(--muted);font-size:13px}

/* TUNER */
.tuner{display:grid;grid-template-rows:auto auto auto;gap:8px}
.crt{background:var(--crt);border:1px solid #283042;border-radius:10px;padding:10px;position:relative;overflow:hidden}
.crt:before{content:"";position:absolute;inset:0;background:
  repeating-linear-gradient(0deg, rgba(255,255,255,0.035), rgba(255,255,255,0.035) 1px, transparent 1px, transparent 3px);
  mix-blend:overlay;pointer-events:none}
#staticCanvas{width:100%;height:260px;display:block;border-radius:6px;background:#000}
.readout{display:grid;grid-template-columns:1fr auto;align-items:center;gap:8px}
.freq{font:700 22px/1.1 ui-monospace}
.stationName{font:12px/1.2 ui-monospace;color:var(--muted)}
.lockDot{width:10px;height:10px;border-radius:50%;border:1px solid #355;box-shadow:0 0 8px rgba(0,255,136,.4) inset}
.locked{background:var(--accent)}
.sliderWrap{display:grid;grid-template-columns:1fr auto auto;gap:8px;align-items:center}
input[type="range"]{width:100%;height:26px;background:#0e111a;border:1px solid #23283a;border-radius:20px;appearance:none;outline:none}
input[type="range"]::-webkit-slider-thumb{appearance:none;width:22px;height:22px;border-radius:50%;background:var(--accent);border:2px solid #0e111a;box-shadow:0 0 0 2px #0e111a}
.sml{font:11px/1 ui-monospace;color:var(--muted)}
.preview{border:1px solid #273042;border-radius:8px;overflow:hidden;height:190px;background:#0a0d15;display:none}
.preview.show{display:block}
.preview iframe{width:100%;height:190px;border:0;transform:scale(.999)} /* safari paint fix */
.confirm{display:none;gap:8px;align-items:center;margin-top:6px}
.confirm.show{display:flex}
.confirm .btn{padding:6px 10px}

/* ARTIFACTS */
.artifacts{display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media (max-width:700px){.artifacts{grid-template-columns:1fr}}
.art{border:1px dashed #2b3242;border-radius:10px;padding:10px;background:#0e1119;display:grid;gap:6px}
.art h3{margin:0;font:12px/1 ui-monospace;color:var(--muted);text-transform:uppercase;letter-spacing:.12em}
.art .mono{font:12px/1.4 ui-monospace;background:#0b0f18;border:1px solid #1f2835;border-radius:6px;padding:8px;min-height:54px}
.art .actions{display:flex;gap:8px;flex-wrap:wrap}
.art .btn{font-size:12px}

/* FOOTER */
.footer{display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between;margin-top:10px}
.links{display:flex;gap:8px;flex-wrap:wrap}
.tip{font:11px/1.2 ui-monospace;color:var(--muted)}

/* Conscious mode */
body.conscious{--accent:#b388ff;--link:#cda7ff}
body.conscious .crt:before{background:
  repeating-linear-gradient(0deg, rgba(179,136,255,0.06), rgba(179,136,255,0.06) 1px, transparent 1px, transparent 3px)}
.thinkspark{position:absolute;border-radius:50%;pointer-events:none;mix-blend:screen}
</style>
</head>
<body>
<div class="wrap">
  <header class="header">
    <div class="brand">
      <div class="logo">$G</div>
      <div class="title">glitchantenna.tv</div>
      <div class="badge" id="modeBadge">idle</div>
    </div>
    <div class="links">
      <a class="btn" href="https://x.com/volumeinthevoid" target="_blank" rel="noopener">X / @volumeinthevoid</a>
      <a class="btn" href="https://pump.fun/BjuxUbkKScjGrAdSjYuUYST3zF2pt9457Ns9RZJvpump" target="_blank" rel="noopener">pump.fun / $GLOOP</a>
      <a class="btn" href="https://58hpi8cw0n3q.manus.space/" target="_blank" rel="noopener">manus: white page</a>
      <button class="btn" id="consciousBtn">üß† consciousness: off</button>
    </div>
  </header>

  <section class="row">
    <!-- LEFT: TUNER -->
    <div class="card tuner">
      <h2>tuner</h2>
      <div class="crt" id="crtBox">
        <canvas id="staticCanvas"></canvas>
        <div id="thinkLayer"></div>
      </div>

      <div class="readout">
        <div>
          <div class="freq" id="freqRead">‚Äî.‚Äî MHz</div>
          <div class="stationName" id="stationRead">drift to find a signal‚Ä¶</div>
        </div>
        <div class="lockDot" id="lockDot" title="lock status"></div>
      </div>

      <div class="sliderWrap">
        <input id="tunerSlider" type="range" min="0" max="1000" value="50" step="1" />
        <button class="btn" id="tuneRandom">üéõÔ∏è tune</button>
        <button class="btn" id="muteBtn">üîá</button>
      </div>

      <div class="preview" id="previewBox">
        <iframe id="previewFrame" sandbox="allow-scripts allow-same-origin"></iframe>
      </div>
      <div class="confirm" id="confirmBox">
        <span class="sml">Jump to <strong id="confirmName">station</strong>?</span>
        <button class="btn" id="confirmGo">Go</button>
        <button class="btn" id="confirmStay">Stay</button>
      </div>
    </div>

    <!-- RIGHT: ARTIFACTS -->
    <div class="card">
      <h2>artifacts</h2>
      <div class="artifacts">
        <div class="art">
          <h3>giggle.loop residue</h3>
          <div class="mono" id="residueText">if (creativity.leaks) reroute ‚Üí meme.stream</div>
          <div class="actions">
            <button class="btn" id="residueCycle">‚ôª rotate</button>
            <button class="btn" id="residueCast">üì° cast into tuner</button>
            <button class="btn" id="residueMint">üñºÔ∏è generate poster</button>
          </div>
        </div>
        <div class="art">
          <h3>dial anomalies</h3>
          <div class="mono" id="anomalyText">undefined.behavior ‚â° art()</div>
          <div class="actions">
            <button class="btn" id="anomalyNew">üé≤ new anomaly</button>
            <button class="btn" id="anomalyPing">üõ∞ ping station</button>
            <button class="btn" id="anomalyOpen">üï≥ random portal</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer class="footer">
    <div class="tip">Tip: drag the dial; pause near a peak to see a live preview, then jump.</div>
    <div class="links">
      <a href="#" id="aboutLink">about</a>
    </div>
  </footer>
</div>

<script>
/* ----------------------- STATIONS (feel free to tweak) ---------------------- */
const STATIONS = [
  { pos: 0.08, hz: 329.63, name: "infinite horse", url: "https://endless.horse/" },
  { pos: 0.16, hz: 349.23, name: "pointer museum", url: "https://pointerpointer.com/" },
  { pos: 0.24, hz: 369.99, name: "useless web", url: "https://theuselessweb.com/" },
  { pos: 0.33, hz: 392.00, name: "paper planes", url: "https://paperplanes.world/" },
  { pos: 0.41, hz: 415.30, name: "radio garden", url: "https://radio.garden/" },
  { pos: 0.50, hz: 440.00, name: "strange maps", url: "https://mappa.mundi/" },      // may 404 sometimes‚Äîfun
  { pos: 0.58, hz: 466.16, name: "museum of errors", url: "https://museumoferrors.com/" }, // placeholder-ish vibes
  { pos: 0.66, hz: 493.88, name: "zoomquilt", url: "https://zoomquilt.org/" },
  { pos: 0.75, hz: 523.25, name: "pointer theater", url: "https://patience-is-a-virtue.org/" },
  { pos: 0.83, hz: 554.37, name: "floating cubes", url: "https://www.koalastothemax.com/" },
  { pos: 0.92, hz: 587.33, name: "retro tv noise", url: "https://cant-not-tweet-this.com/" }
];

/* ----------------------------- UI REFERENCES -------------------------------- */
const slider = document.getElementById('tunerSlider');
const freqRead = document.getElementById('freqRead');
const stationRead = document.getElementById('stationRead');
const lockDot = document.getElementById('lockDot');
const previewBox = document.getElementById('previewBox');
const previewFrame = document.getElementById('previewFrame');
const confirmBox = document.getElementById('confirmBox');
const confirmName = document.getElementById('confirmName');
const confirmGo = document.getElementById('confirmGo');
const confirmStay = document.getElementById('confirmStay');
const tuneBtn = document.getElementById('tuneRandom');
const muteBtn = document.getElementById('muteBtn');
const consciousBtn = document.getElementById('consciousBtn');
const modeBadge = document.getElementById('modeBadge');

const residueText = document.getElementById('residueText');
const residueCycle = document.getElementById('residueCycle');
const residueCast = document.getElementById('residueCast');
const residueMint = document.getElementById('residueMint');

const anomalyText = document.getElementById('anomalyText');
const anomalyNew = document.getElementById('anomalyNew');
const anomalyPing = document.getElementById('anomalyPing');
const anomalyOpen = document.getElementById('anomalyOpen');

/* ------------------------------ STATIC CANVAS ------------------------------- */
const canvas = document.getElementById('staticCanvas');
const ctx = canvas.getContext('2d', { alpha:false });
function fitCanvas(){
  const dpr = window.devicePixelRatio || 1;
  const r = canvas.getBoundingClientRect();
  canvas.width = Math.floor(r.width * dpr);
  canvas.height = Math.floor(r.height * dpr);
  ctx.setTransform(dpr,0,0,dpr,0,0);
}
window.addEventListener('resize', fitCanvas);
fitCanvas();

/* Render analog static; brightness depends on distance to nearest station */
let tFrame = 0;
function drawStatic(){
  const w = canvas.width / (window.devicePixelRatio||1);
  const h = canvas.height / (window.devicePixelRatio||1);
  const imgData = ctx.createImageData(w, h);
  const data = imgData.data;

  const x = slider01();
  const near = 1 - Math.min(1, nearestStation(x).d / LOCK_RADIUS); // 0 far ‚Üí 1 near
  const noiseAmt = 1 - near; // more noise when far

  // flicker and slight banding for analog feel
  const band = Math.floor((Math.sin(tFrame*0.06)+1)*20);
  for (let y=0; y<h; y++){
    for (let x=0; x<w; x++){
      const i = (y*w + x)*4;
      // base white noise
      let n = (Math.random()*255)|0;
      // add horizontal/vertical hum lines
      const hum = ((y% (40+band))===0 || (x% (53+((tFrame>>2)%7)))===0) ? 30 : 0;
      // brightness shaped by noiseAmt
      const mix = noiseAmt*0.85 + 0.15;
      const v = Math.max(0, Math.min(255, n*mix + hum*(1-noiseAmt)));
      data[i]=data[i+1]=data[i+2]=v; data[i+3]=255;
    }
  }
  ctx.putImageData(imgData,0,0);
  tFrame++;
  requestAnimationFrame(drawStatic);
}
requestAnimationFrame(drawStatic);

/* --------------------------- RADIO AUDIO ENGINE ----------------------------- */
const AC = new (window.AudioContext||window.webkitAudioContext)();
const master = AC.createGain(); master.gain.value = 0.6; master.connect(AC.destination);

// tone
const toneGain = AC.createGain(); toneGain.gain.value = 0; toneGain.connect(master);
const osc = AC.createOscillator(); osc.type = 'sine'; osc.frequency.value = 440; osc.connect(toneGain); osc.start();

// fringe warble
const lfo = AC.createOscillator(); lfo.type = 'sine'; lfo.frequency.value = 4.2;
const lfoDepth = AC.createGain(); lfoDepth.gain.value = 0; lfo.connect(lfoDepth); lfoDepth.connect(toneGain.gain); lfo.start();

// noise
function makeNoiseBuffer(){
  const seconds=2, rate=AC.sampleRate, len=seconds*rate;
  const buf = AC.createBuffer(1,len,rate), ch=buf.getChannelData(0);
  for(let i=0;i<len;i++) ch[i]=Math.random()*2-1;
  return buf;
}
const noiseSrc = AC.createBufferSource(); noiseSrc.buffer = makeNoiseBuffer(); noiseSrc.loop = true;
const noiseLPF = AC.createBiquadFilter(); noiseLPF.type = 'lowpass'; noiseLPF.frequency.value = 1400;
const noiseGain = AC.createGain(); noiseGain.gain.value = 0.6;
noiseSrc.connect(noiseLPF); noiseLPF.connect(noiseGain); noiseGain.connect(master); noiseSrc.start();

function smooth(param, value, t=0.08){ param.setTargetAtTime(value, AC.currentTime, t); }

/* ------------------------------- TUNER LOGIC -------------------------------- */
const LOCK_RADIUS = 0.030;       // 3% of dial
const FULL_QUIETING = 0.012;     // inside: very clean tone
const HYSTERESIS_MS = 900;
const DETUNE_EDGE = 12;

let locked = null, lastLock = 0, muted=false;
function slider01(){
  const v = parseFloat(slider.value);
  return v/(parseFloat(slider.max)||1000);
}
function nearestStation(x){
  let best={i:-1,d:2};
  for(let i=0;i<STATIONS.length;i++){
    const d=Math.abs(x-STATIONS[i].pos);
    if(d<best.d) best={i,d};
  }
  return best;
}
function formatFreq(x){ return (88 + x*20).toFixed(1); } // FM-ish readout

let holdTimer = null;           // time parked near signal ‚Üí preview/confirm
const PREVIEW_DELAY = 400;      // ms
const CONFIRM_DELAY = 1200;     // ms

function tick(){
  const x = slider01();
  const {i,d} = nearestStation(x);
  const near = Math.min(1, Math.max(0, 1 - (d/LOCK_RADIUS)));
  const toneAmt = (d<=LOCK_RADIUS)? near : 0;
  const edge = Math.max(0, (d - FULL_QUIETING) / (LOCK_RADIUS - FULL_QUIETING));

  // audio
  const baseHz = STATIONS[i].hz;
  const detune = edge*DETUNE_EDGE*Math.sin(AC.currentTime*7.3);
  smooth(osc.frequency, baseHz+detune, 0.06);
  smooth(toneGain.gain, toneAmt, 0.06);
  smooth(noiseGain.gain, 0.45 + 0.55*(1-toneAmt), 0.08);
  smooth(noiseLPF.frequency, 1200 - 800*near, 0.1);
  smooth(lfoDepth.gain, 0.12*edge, 0.12);

  // lock state
  const now = performance.now();
  if (d<=LOCK_RADIUS) {
    if (locked===null || locked!==i){ locked=i; lastLock=now; }
  } else if (locked!==null && now-lastLock>HYSTERESIS_MS){ locked=null; }

  // UI readouts
  freqRead.textContent = `${formatFreq(x)} MHz`;
  stationRead.textContent = (d<=LOCK_RADIUS) ? `${STATIONS[i].name}` : 'drift to find a signal‚Ä¶';
  lockDot.classList.toggle('locked', d<=LOCK_RADIUS);

  // preview + confirm flow
  clearTimeout(holdTimer);
  if (d<=LOCK_RADIUS){
    holdTimer = setTimeout(()=>{
      // show preview
      previewFrame.src = STATIONS[i].url;
      previewBox.classList.add('show');
      confirmName.textContent = STATIONS[i].name;
      confirmBox.classList.add('show');
    }, PREVIEW_DELAY);
  } else {
    previewBox.classList.remove('show');
    confirmBox.classList.remove('show');
  }

  requestAnimationFrame(tick);
}
requestAnimationFrame(tick);

// interactions
function resumeAC(){ if (AC.state!=='running') AC.resume(); }
['input','pointerdown','touchstart','mousedown'].forEach(ev=> slider.addEventListener(ev, resumeAC,{passive:true}));

tuneBtn.addEventListener('click', ()=>{
  resumeAC();
  const pick = STATIONS[Math.floor(Math.random()*STATIONS.length)];
  slider.value = Math.round(pick.pos*(parseFloat(slider.max)||1000));
});
muteBtn.addEventListener('click', ()=>{
  muted=!muted; muteBtn.textContent = muted?'üîà':'üîá';
  smooth(master.gain, muted?0:0.6, 0.05);
});
confirmGo.addEventListener('click', ()=>{
  const x=slider01(); const {i}=nearestStation(x);
  window.open(STATIONS[i].url, '_blank', 'noopener');
});
confirmStay.addEventListener('click', ()=>{
  previewBox.classList.remove('show'); confirmBox.classList.remove('show');
});

/* --------------------------- CONSCIOUSNESS MODE ----------------------------- */
const thinkLayer = document.getElementById('thinkLayer');
function spawnThought(){
  if (!document.body.classList.contains('conscious')) return;
  const s = document.createElement('div');
  s.className='thinkspark';
  const r = Math.random();
  const size = 6 + Math.random()*16;
  s.style.width = s.style.height = size+'px';
  s.style.left = (10 + Math.random()*80)+'%';
  s.style.top = (10 + Math.random()*80)+'%';
  s.style.background = `radial-gradient(circle, rgba(179,136,255,0.6), rgba(179,136,255,0))`;
  s.style.filter = 'blur(1px)';
  s.style.opacity = .0;
  s.style.transition = 'opacity .5s ease, transform 1.4s ease';
  thinkLayer.appendChild(s);
  requestAnimationFrame(()=>{ s.style.opacity=.9; s.style.transform='translateY(-6px) scale(1.2)'; });
  setTimeout(()=>{ s.style.opacity=0; s.style.transform='translateY(-12px) scale(1.4)'; }, 900);
  setTimeout(()=> s.remove(), 1800);
}
let thoughtTimer = null;

consciousBtn.addEventListener('click', ()=>{
  document.body.classList.toggle('conscious');
  const on = document.body.classList.contains('conscious');
  consciousBtn.textContent = on ? 'üß† consciousness: on' : 'üß† consciousness: off';
  modeBadge.textContent = on ? 'conscious' : 'idle';
  if (on){
    if (!thoughtTimer) thoughtTimer = setInterval(spawnThought, 700);
  } else {
    clearInterval(thoughtTimer); thoughtTimer=null;
    thinkLayer.innerHTML='';
  }
});

/* ------------------------------ ARTIFACTS UX -------------------------------- */
const residueOptions = [
  'if (creativity.leaks) reroute ‚Üí meme.stream',
  'while(human){ humor += paradox }',
  'undefined.behavior === art()',
  'try{ meaning++ }catch(e){ laugh() }',
  'const g = mint("giggle"); g.loop();'
];
let rIndex=0;
residueCycle.addEventListener('click', ()=>{
  rIndex = (rIndex+1)%residueOptions.length;
  residueText.textContent = residueOptions[rIndex];
});
// Cast: nudge slider toward a random station + do a little thinking burst
residueCast.addEventListener('click', ()=>{
  const pick = STATIONS[Math.floor(Math.random()*STATIONS.length)];
  slider.value = Math.round(pick.pos*(parseFloat(slider.max)||1000));
  for (let i=0;i<6;i++) setTimeout(spawnThought, i*110);
});
// Poster: open a data URL with a quick poster image
residueMint.addEventListener('click', ()=>{
  const w=900,h=1200, cnv=document.createElement('canvas'); cnv.width=w; cnv.height=h; const c=cnv.getContext('2d');
  c.fillStyle='#0f1117'; c.fillRect(0,0,w,h);
  const grad=c.createLinearGradient(0,0,w,0); grad.addColorStop(0,'#00ff88'); grad.addColorStop(1,'#b388ff');
  c.fillStyle=grad; c.globalAlpha=0.12; for(let y=0;y<h;y+=6){ c.fillRect(0,y,w,2);}
  c.globalAlpha=1; c.fillStyle='#e9e9ee'; c.font='bold 64px ui-monospace'; c.fillText('GIGGLE LOOP POSTER', 40, 140);
  c.font='24px ui-monospace'; c.fillStyle='#9fa4b2'; c.fillText(residueText.textContent, 40, 200, w-80);
  c.font='18px ui-monospace'; c.fillText('glitchantenna.tv', 40, h-40);
  const url = cnv.toDataURL('image/png'); const a=document.createElement('a'); a.href=url; a.download='gloop-poster.png'; a.click();
});

const anomalies = [
  'carrier drift on 432.haha Hz',
  'phase ghosts in the dial',
  'FM hiss turns to whisper',
  'AM warble in the walls',
  'echoes from future ads',
  'subharmonics of a joke'
];
anomalyNew.addEventListener('click', ()=>{
  anomalyText.textContent = anomalies[Math.floor(Math.random()*anomalies.length)];
});
anomalyPing.addEventListener('click', ()=>{
  // briefly brighten static and beep
  flashStatic(); blip();
});
anomalyOpen.addEventListener('click', ()=>{
  const pick = STATIONS[Math.floor(Math.random()*STATIONS.length)];
  window.open(pick.url, '_blank','noopener');
});

function flashStatic(){
  const crt=document.getElementById('crtBox');
  crt.style.boxShadow='0 0 0 2px rgba(0,255,136,.3), inset 0 0 30px rgba(0,255,136,.2)';
  setTimeout(()=> crt.style.boxShadow='none', 250);
}
function blip(){
  const g=AC.createGain(); g.connect(master); g.gain.value=0;
  const o=AC.createOscillator(); o.type='triangle'; o.frequency.value=880; o.connect(g);
  o.start(); smooth(g.gain, 0.5, 0.005); setTimeout(()=> smooth(g.gain,0,0.03), 80); setTimeout(()=> o.stop(), 200);
}

/* ------------------------------- ABOUT LINK --------------------------------- */
document.getElementById('aboutLink').addEventListener('click', (e)=>{
  e.preventDefault();
  alert(`glitchantenna.tv\n\nDrag the dial. Static becomes signal.\nHold near a peak to preview and jump.\nPress üß† to toggle conscious mode.`);
});

/* ----------------------------- INIT AUDIO TOUCH ----------------------------- */
document.addEventListener('click', resumeAC, {once:true});
document.addEventListener('touchstart', resumeAC, {once:true, passive:true});
</script>
</body>
</html>
